name: Keep Supabase Active

on:
  schedule:
    # Tous les 3 jours à 10h00 UTC (12h00 Paris)
    - cron: '48 14 */3 * *'
  
  # Permet aussi de lancer manuellement
  workflow_dispatch:

jobs:
  ping-supabase:
    runs-on: ubuntu-latest
    
    steps:
      - name: Appeler l'endpoint Bubble
        run: |
          curl -X POST "https://rsdcampusfrance.bubbleapps.io/version-test/api/1.1/wf/keepalive"
      
      - name: Requête directe Supabase (backup)
        run: |
          curl -X GET "https://bdblrcbyobsgfnlkguzj.supabase.co/rest/v1/comments?select=id&limit=1" \
            -H "apikey: ${{ secrets.SUPABASE_KEY }}" \
            -H "Authorization: Bearer ${{ secrets.SUPABASE_KEY }}"
